<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>In Stock | Abbeyâ€™s Creations</title>
  <meta name="description" content="See what handmade creations are currently in stock at Abbeyâ€™s Creations. Cups, hats, records, and more!" />
  <link rel="icon" href="Images/Cup.png" type="image/png" />

  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&family=Dancing+Script:wght@600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="css/style.css" />

  <meta property="og:title" content="In Stock | Abbeyâ€™s Creations" />
  <meta property="og:description" content="Browse the latest handmade creations from Abbeyâ€™s Creations â€” cups, hats, records, and more." />
  <meta property="og:image" content="Images/Hat.png" />
  <meta property="og:type" content="website" />
</head>

<body class="instock">
  <header>
    <h1>Abbeyâ€™s Creations</h1>
    <p class="tagline">Handmade With Heart ðŸ’–</p>

    <nav>
      <ul>
        <li><a href="index.html">Home</a></li>
        <li><a href="in-stock.html" class="active">In Stock</a></li>
        <li><a href="custom.html">Custom Orders</a></li>
      </ul>
    </nav>
  </header>

  <main id="main">
    <section class="hero">
      <h2>Available Creations</h2>
      <p>These are ready to order right now! Each piece is unique â€” when itâ€™s gone, itâ€™s gone.</p>
    </section>

    <section class="showcase">
      <div class="grid" id="stock-grid">
        <p>Loading latest items...</p>
      </div>
      <p id="last-updated" style="text-align:center; font-size:0.9rem; color:#6b2b46; margin-top:1rem;"></p>
    </section>
  </main>

  <footer>
    <p>&copy; 2025 Abbeyâ€™s Creations. All designs handmade with love.</p>
  </footer>

  <!-- Live Google Sheet Sync -->
  <script>
    const SHEET_URL = "https://docs.google.com/spreadsheets/d/1UbcUkLrRsTNpOTOBqvHbro_qKQkXTEJ7CeHDKkkMyFw/gviz/tq?tqx=out:json";

    async function loadSheetData() {
      const grid = document.getElementById("stock-grid");
      const timestamp = document.getElementById("last-updated");

      try {
        const response = await fetch(SHEET_URL);
        const text = await response.text();
        const json = JSON.parse(text.substring(47).slice(0, -2)); // Clean up weird JSON prefix
        const rows = json.table.rows;

        grid.innerHTML = ""; // clear existing content

        rows.forEach(row => {
          const [item, price, qty, image, desc] = row.c.map(c => c ? c.v : "");
          if (!item) return; // skip empty rows

          const card = document.createElement("div");
          card.classList.add("card");
          card.innerHTML = `
            <img src="${image}" alt="${item}" loading="lazy">
            <h3>${item}</h3>
            <p>${desc}</p>
            <p><strong>${price}</strong> â€” ${qty} available</p>
            <a class="cta" href="mailto:example@email.com?subject=Order%20${encodeURIComponent(item)}">Order Now</a>
          `;
          grid.appendChild(card);
        });

        const now = new Date();
        timestamp.textContent = "Last updated: " + now.toLocaleString();
      } catch (err) {
        console.error("Error loading sheet data:", err);
        grid.innerHTML = "<p>Unable to load items right now.</p>";
        timestamp.textContent = "";
      }
    }

    loadSheetData();
  </script>
</body>
</html>
